<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css">
body{
	background-color: transparent;
}
.pics {
	height: 232px;
	width: 232px;
	padding: 0;
	margin: 0;
	cursor: pointer;
}

#nav {
	padding: 0
}

#nav a {
	margin: 0 5px;
	padding: 3px 5px;
	border: 1px solid #ccc;
	background: #fc0;
	text-decoration: none
}

#nav a.activeSlide {
	background: #ea0
}

#nav a:focus {
	outline: none;
}

marquee {
	font-size: 30px;
	color: white;
}
</style>
<!-- <script type="text/javascript" src="./js/test.js"></script>  -->
<script type="text/javascript" src="./js/jquery-1.4.4.min.js"></script>
<script type="text/javascript" src="./js/jquery.cycle.all.js"></script>
<script type="text/javascript" src="./js/index.js"></script>
<script type="text/javascript" src="./js/keyEvent.js"></script>


<script type="text/javascript">
initPage(window); //初始化
var video_server="";
var igmp_addr="";//直播
//var local_igmp_addr="";//本地组播
// var station_url="./../../../../stationinfo/station.json";  //到站信息请求地址
// var msg_url="./../../../../message/msg.json";
// var playtype_url="./../../../../message/playtype.json";
// var debug_status=iPanel.ioctlRead("debug_status");
function init(){
	video_server=thisSW_Stb.Read("video_server");
	igmp_addr=thisSW_Stb.Read("igmp_addr");
	//local_igmp_addr=thisSW_Stb.Read("local_igmp_addr");
	getdocument();
	/**
	setInterval(function(){
		station_ajax_photo();
	}, 1000);
	**/
	/* setInterval(function(){
		msg_ajax();
	}, 2000); */
	
	/*setInterval(function(){
	if(debug_status==1 || debug_status=="1")
		playtype_ajax();
		}, 2000)
	*/
	}
	function eventHandler(eventObj) {
		thisSW_Stb.PrintLog("event  = " + eventObj.code);
		switch (eventObj.code) {
		case "KEY_LEFT":
			break;
		case "KEY_RIGHT":
			break;
		case "KEY_BACK":
			break;
		case "KEY_OK":
			break;
		case "KEY_DOWN":
			break;
		case "KEY_UP":
			break;
		case "KEY_PAGEUP":
			break;
		case "KEY_PAGEDOWN":
			break;
		case "KEY_EVENT":
			doEvent();
			break;

		}
		return 0;
	}
		function doEvent() {
			if (window.EventStr) {
				var obj = null;
				eval("obj=" + window.EventStr);
				if (obj) {
					switch(obj.type) {
					case "EVENT_MEDIA_BEGINING":
						break;
					case "EVENT_MEDIA_END":
						thisSW_MediaPlayer.stop();
						if(sdArrary.length>0){
							sdDataPos++;
							if(sdDataPos==sdArrary.length){
								sdDataPos=0;
							}
							
							// 注释这段代码 再 正常模式下使用（不是用来发组播）
							var playurl;
							if(igmp_addr && igmp_addr!=null && igmp_addr!=""){
									playurl=igmp_addr;
								}else{
								 if(sdArrary[sdDataPos].src.indexOf('udp:')!=-1 || sdArrary[sdDataPos].src.indexOf('igmp:')!=-1 || sdArrary[sdDataPos].src.indexOf('http:')!=-1){
										playurl=sdArrary[sdDataPos].src;
								 } else 
								 	playurl=video_server+sdArrary[sdDataPos].src;
								}
							// var playurl=igmp_addr;
							setTimeout(function(){
								thisSW_MediaPlayer.play(playurl,true);
							}, 100)
						}
						break;
					case "EVENT_PLAYMODE_CHANGE":
						if(positionArray.length>0){
							thisSW_MediaPlayer.setPig(positionArray[0],(positionArray[1]+10),positionArray[2],positionArray[3])
						}
						break;
					case "EVENT_MEDIA_ERROR":
						break;
					case "EVENT_PLAY_TYPE"://
					var ptype=obj.message;
					thisSW_Stb.PrintLog("ptype  = " + ptype);
					var str="";
						if(ptype=="LIVE_PLAY"){
							str="直播";
						}else if(ptype=="EMERGENCY_PLAY"){
							str="紧急播放";
						}else if(ptype=="RECORD_PLAY"){
							str="录播";
						}
						var my=document.getElementById("temp");
						if(my!=null){
							my.parentNode.removeChild(my);
							}
							getDiv(positionArray[0]+positionArray[2]-300,positionArray[1],str);

						/**
						var id=document.getElementById("strid");
						if(id && id!=null){
							id.innerHTML="";
							id.innerHTML=str
							}else{
								
								var div=getDiv(positionArray[0]+positionArray[2]-300,positionArray[1],str);
							}
						**/
						//document.body.appendChild(div);
						break;
					case "EVENT_REPORT_STATION":
						var mess=obj.message;
						updatestation(mess);
						
						break;
					case "EVENT_ADJUST_TIME":  
						clearInterval(datetimer);
						window.location.reload(); 
						
					break;
					
					case "EVENT_ADJUST_WINDOW":
						var type=obj.message;
						if(type=='FULL_SCREEN'){
							document.body.style.display="none";
							thisSW_MediaPlayer.setFullScreen();
						}else if(type=='PIG_SCREEN'){
							document.body.style.display="block";
							thisSW_MediaPlayer.setPig(positionArray[0],(positionArray[1]+10),positionArray[2],positionArray[3])
						}
						break;
						
					}
				}
			}
		}
		
		function getDiv(x,y,str){
			var my=document.getElementById("temp");
			if(my!=null){
				my.parentNode.removeChild(my);
				}
			var div = document.createElement("div");
			//div.id = region.id;
			div.id = "temp";
			div.style.zIndex = 100;
			div.style.position = "absolute";
			div.style.left = x;
			div.style.top = y;
			div.style.width = "300px";
			div.style.height = "30px";
		//	div.style.backgroundColor="red";
			div.style.background="transparent";
			var str1="<div id='strid' style='width:100%;height:auto;color:ffffff;text-align:center;font-size: 30px;'>"+str+"</div>";
			div.innerHTML=str1;
			document.body.appendChild(div);
			//return div;
			
		}	
	function exit(){
		thisSW_MediaPlayer.stop();
	}
</script>

</head>
<body onload="init()" onunload="exit()">
<div id="msg" style="position: absolute;bottom: 0px;height: auto;width: 100%;z-index: 1000;" align="center">
</div>
</body>
</html>
